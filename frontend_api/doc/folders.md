# Документация API для работы с папками

## Обзор

API для работы с папками позволяет пользователям управлять своими папками и организовывать карточки проектов. Пользователи могут создавать, просматривать, обновлять и удалять папки, а также управлять содержимым папок, добавляя или удаляя карточки.

## Базовый URL
```
{{baseUrl}}/f-api/
```

## Аутентификация

Все запросы к API требуют аутентификации с использованием JWT токена. Токен должен быть передан в заголовке `Authorization` в формате `Bearer {token}`.

## Эндпоинты управления папками

### 1. Получение списка папок
```http
GET /folders/
Authorization: Bearer {{accessToken}}
```

**Описание:** Возвращает список всех папок пользователя с информацией о количестве карточек в каждой папке.

**Ответ (успех):**
```json
{
  "success": true,
  "folders": [
    {
      "id": 1,
      "name": "Favorites",
      "description": "Папка для избранных карточек",
      "is_default": true,
      "created_at": "2025-03-12T16:58:08.002189+00:00",
      "updated_at": "2025-03-12T16:58:08.002241+00:00",
      "cards_count": 1
    },
    {
      "id": 25,
      "name": "Test",
      "description": "",
      "is_default": false,
      "created_at": "2025-03-20T15:53:14.564060+00:00",
      "updated_at": "2025-03-31T11:50:10.932795+00:00",
      "cards_count": 0
    }
  ]
}
```

**Возможные ошибки:**
| Код ошибки | Описание |
|------------|----------|
| `AUTHENTICATION_FAILED` | Ошибка аутентификации |
| `SERVER_ERROR` | Внутренняя ошибка сервера |

### 2. Создание новой папки
```http
POST /folders/
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Новая папка",
  "description": "Описание новой папки"
}
```

**Параметры запроса:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `name` | string | Название папки (обязательный) |
| `description` | string | Описание папки (опциональный) |
| `is_default` | boolean | Флаг папки по умолчанию (опциональный, обычно false) |

**Описание:** Создает новую папку для пользователя.

**Ответ (успех):**
```json
{
  "success": true,
  "folder": {
    "id": 63,
    "name": "Новая папка",
    "description": "Описание новой папки",
    "is_default": false,
    "created_at": "2025-05-10T16:16:57.436712+00:00",
    "updated_at": "2025-05-10T16:16:57.436794+00:00",
    "cards_count": 0
  }
}
```

**Возможные ошибки:**
| Код ошибки | Описание |
|------------|----------|
| `AUTHENTICATION_FAILED` | Ошибка аутентификации |
| `MISSING_NAME` | Отсутствует название папки |
| `DUPLICATE_NAME` | Папка с таким названием уже существует |
| `SERVER_ERROR` | Внутренняя ошибка сервера |

### 3. Получение информации о папке
```http
GET /folders/{folder_id}/
Authorization: Bearer {{accessToken}}
```

**Параметры URL:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `folder_id` | integer | ID папки для получения информации |

**Описание:** Возвращает детальную информацию о конкретной папке.

**Ответ (успех):**
```json
{
  "success": true,
  "folder": {
    "id": 1,
    "name": "Favorites",
    "description": "Папка для избранных карточек",
    "is_default": true,
    "created_at": "2025-03-12T16:58:08.002189+00:00",
    "updated_at": "2025-03-12T16:58:08.002241+00:00",
    "cards_count": 1
  }
}
```

**Возможные ошибки:**
| Код ошибки | Описание |
|------------|----------|
| `AUTHENTICATION_FAILED` | Ошибка аутентификации |
| `NOT_FOUND` | Папка не найдена |
| `SERVER_ERROR` | Внутренняя ошибка сервера |

### 4. Обновление папки
```http
PUT /folders/{folder_id}/
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Обновленное название",
  "description": "Обновленное описание"
}
```

**Параметры URL:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `folder_id` | integer | ID папки для обновления |

**Параметры запроса:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `name` | string | Новое название папки (обязательный) |
| `description` | string | Новое описание папки (опциональный) |

**Описание:** Обновляет информацию о существующей папке.

**Ответ (успех):**
```json
{
  "success": true,
  "folder": {
    "id": 1,
    "name": "Обновленное название",
    "description": "Обновленное описание",
    "is_default": true,
    "created_at": "2025-03-12T16:58:08.002189+00:00",
    "updated_at": "2025-05-10T16:17:44.200764+00:00",
    "cards_count": 1
  }
}
```

**Возможные ошибки:**
| Код ошибки | Описание |
|------------|----------|
| `AUTHENTICATION_FAILED` | Ошибка аутентификации |
| `NOT_FOUND` | Папка не найдена |
| `MISSING_NAME` | Отсутствует название папки |
| `DUPLICATE_NAME` | Папка с таким названием уже существует |
| `SERVER_ERROR` | Внутренняя ошибка сервера |

### 5. Удаление папки
```http
DELETE /folders/{folder_id}/
Authorization: Bearer {{accessToken}}
```

**Параметры URL:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `folder_id` | integer | ID папки для удаления |

**Описание:** Удаляет папку. Папку по умолчанию удалить нельзя.

**Ответ (успех):**
```json
{
  "success": true,
  "message": "Папка успешно удалена"
}
```

**Возможные ошибки:**
| Код ошибки | Описание |
|------------|----------|
| `AUTHENTICATION_FAILED` | Ошибка аутентификации |
| `NOT_FOUND` | Папка не найдена |
| `DEFAULT_FOLDER` | Нельзя удалить папку по умолчанию |
| `SERVER_ERROR` | Внутренняя ошибка сервера |


### 7. Получение списка папок для карточки
```http
GET /cards/{card_id}/folders/
Authorization: Bearer {{accessToken}}
```

**Параметры URL:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `card_id` | integer | ID карточки для получения списка папок |

**Описание:** Возвращает список всех папок пользователя с информацией о том, находится ли указанная карточка в каждой из папок.

**Ответ (успех):**
```json
{
  "success": true,
  "folders": [
    {
      "id": 1,
      "name": "Favorites",
      "is_default": true,
      "has_card": true
    },
    {
      "id": 25,
      "name": "Test",
      "is_default": false,
      "has_card": false
    }
  ]
}
```

**Возможные ошибки:**
| Код ошибки | Описание |
|------------|----------|
| `AUTHENTICATION_FAILED` | Ошибка аутентификации |
| `CARD_NOT_FOUND` | Карточка не найдена |
| `SERVER_ERROR` | Внутренняя ошибка сервера |

### 8. Обновление папок для карточки
```http
POST /cards/{card_id}/folders/
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "include_folders": [1, 3],
  "exclude_folders": [2]
}
```

**Параметры URL:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `card_id` | integer | ID карточки для обновления списка папок |

**Параметры запроса:**
| Параметр | Тип | Описание |
|----------|-----|----------|
| `include_folders` | array | Массив ID папок, в которые нужно добавить карточку |
| `exclude_folders` | array | Массив ID папок, из которых нужно удалить карточку |

**Описание:** Обновляет список папок, в которых находится карточка.

**Ответ (успех):**
```json
{
  "success": true,
  "message": "Папки карточки обновлены"
}
```

**Возможные ошибки:**
| Код ошибки | Описание |
|------------|----------|
| `AUTHENTICATION_FAILED` | Ошибка аутентификации |
| `CARD_NOT_FOUND` | Карточка не найдена |
| `FORBIDDEN` | Одна из указанных папок не принадлежит пользователю |
| `SERVER_ERROR` | Внутренняя ошибка сервера |

## Примечания

1. Папка с `is_default=true` является папкой "Избранное" и не может быть удалена.
2. При добавлении карточки хотя бы в одну папку, она автоматически удаляется из списка удаленных карточек.
3. Карточки в папке сортируются по дате добавления в папку (от новых к старым).
